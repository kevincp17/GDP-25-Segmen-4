<!DOCTYPE html>
<html lang="en">

<head th:insert="layout/header.html :: head">

</head>

<body>
    <div th:replace="layout/header.html :: header">

    </div>

    <div id="profile-div">
        <div id="profile-div1">
            <button>
                <img src="image/profile.png">
            </button>

            <div id="profile-div1-info">
                <p>Kevin Christy Parinussa</p>
                <p>085847394002</p>
                <p>Jl. Kesehatan 8</p>
            </div>

            <div id="profile-div1-edit">
                <button>
                    <i class="fa-solid fa-pen"></i>
                </button>
            </div>
        </div>

        <div id="profile-div2">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <button class="nav-link active" id="nav-skill-tab" data-bs-toggle="tab" data-bs-target="#nav-skill"
                    type="button" role="tab" aria-controls="nav-skill" aria-selected="true"><i class="fa-solid fa-gear"></i>Skill</button>
                <button class="nav-link" id="nav-exp-tab" data-bs-toggle="tab" data-bs-target="#nav-exp"
                    type="button" role="tab" aria-controls="nav-exp" aria-selected="false"><i class="fa-solid fa-briefcase"></i>Experience</button>
                <button class="nav-link" id="nav-edu-tab" data-bs-toggle="tab" data-bs-target="#nav-edu"
                    type="button" role="tab" aria-controls="nav-edu" aria-selected="false"><i class="fa-solid fa-user-graduate"></i>Education</button>
                <button class="nav-link" id="nav-cert-tab" data-bs-toggle="tab" data-bs-target="#nav-cert"
                    type="button" role="tab" aria-controls="nav-cert" aria-selected="false"><i class="fa-solid fa-certificate"></i>Certification</button>
                </div>
              </nav>
        </div>

        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-skill" role="tabpanel" aria-labelledby="nav-skill-tab">
                <div id="nav-skill-div">

                </div>
            </div>

            <div class="tab-pane fade" id="nav-exp" role="tabpanel" aria-labelledby="nav-exp-tab">
                <div id="nav-exp-div">

                </div>
            </div>

            <div class="tab-pane fade" id="nav-edu" role="tabpanel" aria-labelledby="nav-edu-tab">
                <div id="nav-edu-div">

                </div>
            </div>

            <div class="tab-pane fade" id="nav-cert" role="tabpanel" aria-labelledby="nav-cert-tab">
                <div id="nav-cert-div">

                </div>
            </div>
          </div>
    </div>

    <div th:replace="layout/footer.html :: footer">

    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>

    <script>
        let baseUrl = "http://localhost:8088/api/"

        let months=["January","February","March","April","May","June","July","August","September","October","November","December"]

        $.ajax({
                "url": baseUrl +"cvinfo/1/skill",
                "type": "GET",
                "contentType": "application/json"
            }).done((response) => {
                console.log(response.result);
                
                for(let i=0;i<response.result.length;i++){
                    document.getElementById("nav-skill-div").innerHTML+=
                    "<div id='nav-skill-content'>\n"+
                        "<img src='image/"+response.result[i].skill.picture+"'/>\n"+
                        response.result[i].skill.name+
                    "</div>"
                }
            }).fail((error) => {
                console.log(error);
            })

        $.ajax({
                "url": baseUrl +"cvinfo/1/experience",
                "type": "GET",
                "contentType": "application/json"
            }).done((response) => {
                console.log(response.result);                
                for(let i=0;i<response.result.length;i++){
                    let dateStart=new Date(response.result[i].experience.start_date) 
                    var dayStart = dateStart.getDate();
                    var monthStart = dateStart.getMonth();
                    var yearStart = dateStart.getFullYear();

                    let dateEnd=new Date(response.result[i].experience.end_date) 
                    var dayEnd = dateEnd.getDate();
                    var monthEnd = dateEnd.getMonth();
                    var yearEnd = dateEnd.getFullYear();

                    document.getElementById("nav-exp-div").innerHTML+=
                    "<div id='nav-exp-content'>\n"+
                        "<p>"+(response.result[i].experience.job_title).toUpperCase()+"</p>\n"+
                        "<p>"+response.result[i].experience.company_name+"</p>\n"+
                        "<p>"+dayStart+" "+months[monthStart]+" "+yearStart+" - "+dayEnd+" "+months[monthEnd]+" "+yearEnd+"</p>\n"+
                        "<p>"+response.result[i].experience.job_desc+"</p>\n"+
                    "</div>"
                }
            }).fail((error) => {
                console.log(error);
            })

            $.ajax({
                "url": baseUrl +"cvinfo/1/education",
                "type": "GET",
                "contentType": "application/json"
            }).done((response) => {
                console.log(response.result);                
                for(let i=0;i<response.result.length;i++){
                    let dateStart=new Date(response.result[i].education.start_date) 
                    var dayStart = dateStart.getDate();
                    var monthStart = dateStart.getMonth();
                    var yearStart = dateStart.getFullYear();

                    let dateEnd=new Date(response.result[i].education.end_date) 
                    var dayEnd = dateEnd.getDate();
                    var monthEnd = dateEnd.getMonth();
                    var yearEnd = dateEnd.getFullYear();

                    document.getElementById("nav-edu-div").innerHTML+=
                    "<div id='nav-edu-content'>\n"+
                        "<p>"+(response.result[i].education.degree.name).toUpperCase()+" "+(response.result[i].education.major.name).toUpperCase()+"</p>\n"+
                        "<p>"+response.result[i].education.institute.name+"</p>\n"+
                        "<p>"+dayStart+" "+months[monthStart]+" "+yearStart+" - "+dayEnd+" "+months[monthEnd]+" "+yearEnd+"</p>\n"+
                        "<p>GPA "+response.result[i].education.gpa+"</p>\n"+
                    "</div>"
                }
            }).fail((error) => {
                console.log(error);
            })

            $.ajax({
                "url": baseUrl +"cvinfo/1/certificate",
                "type": "GET",
                "contentType": "application/json"
            }).done((response) => {
                console.log(response.result);                
                for(let i=0;i<response.result.length;i++){
                    let dateStart=new Date(response.result[i].certification.issued_date) 
                    var dayStart = dateStart.getDate();
                    var monthStart = dateStart.getMonth();
                    var yearStart = dateStart.getFullYear();

                    document.getElementById("nav-cert-div").innerHTML+=
                    "<div id='nav-cert-content'>\n"+
                        "<p>"+(response.result[i].certification.organizer_name).toUpperCase()+"</p>\n"+
                        "<p>"+response.result[i].certification.certification_name+"</p>\n"+
                        "<p>Issued "+dayStart+" "+months[monthStart]+" "+yearStart+"</p>\n"+
                        "<p>Credential ID "+response.result[i].certification.certification_number+"</p>\n"+
                    "</div>"
                }
            }).fail((error) => {
                console.log(error);
            })

        var popover = new bootstrap.Popover(document.querySelector('#profile-btn'), {
            title: "User Menu",
            container: 'body',
            trigger: 'click',
            html: true,
            content:
                '<a href="profile">View Profile</a>\n' +
                '<hr>\n' +
                '<a id="logout-btn" href="interviews">Logout</a>',
            template:
                '<div class="popover" role="tooltip">\n' +
                '<h3 class="popover-header"></h3>\n' +
                '<div class="popover-body">\n' +
                '</div>\n' +
                '</div>'
        })
    </script>
</body>

</html>